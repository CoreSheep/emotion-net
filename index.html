<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Emotion Net Mini</title>
    <meta name="keywords" content="KG Multimodal emotion net" />
    <meta name="author" content="sheepcore" />
    <link rel="shortcut icon" href="assets/images/icon/project-icon.svg">
    <!--  link outer css stylesheet  -->
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/bootstrap-theme.css">
    <!--    link framework css stylesheet-->
    <link rel="stylesheet" href="css/framework.css">
    <!--    link canvas css stylesheet  -->
    <link rel="stylesheet" href="css/canvas.css">
    <!--    link imageContainer css stylesheet-->
    <link rel="stylesheet" href="css/imageContainer.css">
    
    <!--link outer js lib-->
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.js"></script>
</head>
<body>
<!-- Ê†áÈ¢ò -->
<div style="height: 5em">
    <h1 id="emotionNetName">Emotion Net Mini</h1>
    <div id='darkMode' style="display:inline-block;">
        <span style="position: absolute; right: 30px; margin-bottom: 25px; margin-top: 15px;"><strong>dark mode</strong></span>
    </div>
    <a href="https://github.com/CoreSheep/emotion-net" target="_blank" class="github-icon" style="position: absolute; right: 125px; margin-top: 30px; text-decoration: none;" title="View on GitHub">
        <svg height="20" viewBox="0 0 16 16" version="1.1" width="20" aria-hidden="true" style="fill: currentColor; vertical-align: middle;">
            <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
        </svg>
    </a>
</div>

<!-- ÂÆö‰πâdivÂ≠òÊîæÂÖ≥Á≥ªÂõæ -->
<!-- NOTE: Áà∂ÂÖÉÁ¥†ÈááÁî®Áõ∏ÂØπÂÆö‰ΩçÔºåÈáåÈù¢ÁöÑÂÖÉÁ¥†ÈááÁî®ÁªùÂØπÂÆö‰Ωç -->
<div style="text-align: center;position: relative;">
    <svg width="880" height="580" style="position: relative; top: 15px; margin-left: 30px;margin-bottom: -150px" id="canvas"></svg>
    
    <!-- Ê®°Âºè(circle/text) -->
    <div id="mode">
        <span class="active" style="border-top-right-radius: 0;border-bottom-right-radius: 0;">Circles</span>
        <span style="border-top-left-radius: 0;border-bottom-left-radius: 0;position: relative; left: -9px">&nbsp;Texts</span>
    </div>
    
    <!-- ÊêúÁ¥¢Ê°Ü -->
    <div id="search">
        <input type="text" autocomplete="off" class="form-control">
    </div>
    
    <!-- Âõæ‰æã -->
    <div id="label"></div>
    
    
    <!-- ÊòæÁ§∫ÂàáÊç¢1On /off -->
    <div id="switcher1">
        <span class="active" style="border-top-right-radius: 0;border-bottom-right-radius: 0; padding-right: 14px">On</span>
        <span style="border-top-left-radius: 0;border-bottom-left-radius: 0;position: relative; left: -10px">Off</span>
    </div>
    
    <!-- ÊòæÁ§∫ÂàáÊç¢2On /off-->
    <div id="switcher2">
        <span class="active" style="border-top-right-radius: 0;border-bottom-right-radius: 0; padding-right: 14px">On</span>
        <span style="border-top-left-radius: 0;border-bottom-left-radius: 0;position: relative; left: -10px">Off</span>
    </div>
    
    <!-- ÊòæÁ§∫ÂàáÊç¢3On /off-->
    <div id="switcher3">
        <span class="active" style="border-top-right-radius: 0;border-bottom-right-radius: 0; padding-right: 14px">On</span>
        <span style="border-top-left-radius: 0;border-bottom-left-radius: 0;position: relative; left: -10px">Off</span>
    </div>
    
    <!-- ÊòæÁ§∫ÂàáÊç¢4On /off-->
    <div id="switcher4">
        <span class="active" style="border-top-right-radius: 0;border-bottom-right-radius: 0; padding-right: 14px">On</span>
        <span style="border-top-left-radius: 0;border-bottom-left-radius: 0;position: relative; left: -10px">Off</span>
    </div>
    
    <!-- ÊØè‰∏™ÁªìÁÇπÁöÑ‰ø°ÊÅØ -->
    <div id="labelProperty">
        <h4 style="margin-left: -3px">Word Property</h4>
        <div id="subclass"></div>
        <div id="description"></div>
        <div class="showImage">
            <div class="imageContent">
                <u id="faceImageContainer1"></u>
            </div>
        </div>
        <div id="tag1"></div>
        <div class="showImage">
            <div class="imageContent">
                <u id="faceImageContainer2"></u>
            </div>
        </div>
        <div id="tag2"></div>
        <div class="showImage">
            <div class="imageContent">
                <u id="faceImageContainer3"></u>
            </div>
        </div>
        <div id="tag3"></div>
        <div class="showImage">
            <div class="imageContent">
                <u id="emojiImageContainer"></u>
            </div>
        </div>
        <div id="tag4"></div>
        <div class="showImage">
            <div class="imageContent">
                <u id="animalImageContainer"></u>
            </div>
        </div>
        <div id="tag5"></div>
        <div class="showImage">
            <div class="imageContent">
                <u id="animalImageContainer2"></u>
            </div>
        </div>
        <div id="tag6"></div>
        <div class="showImage">
            <div class="imageContent">
                <u id="animalImageContainer3"></u>
            </div>
        </div>
    </div>
    
    <!-- Tooltips toggle button -->
    <button id="tooltips-toggle">üí° Tips</button>
    
    <!-- ÊèêÁ§∫ -->
    <div id="tooltips" class="tooltips-visible">
        <span style="font-size: 13px; color: rgba(22,116,31,0.78); font-weight: bold">Tips:</span><br>
        <small style="font-size: 10px;">1. Click Circle/Text button to switch between display modes</small><br>
        <small style="font-size: 10px;">2. Click On/Off buttons to show or hide node categories</small><br>
        <small style="font-size: 10px;">3. Drag any node and watch the graph auto-adjust its layout!</small><br>
        <small style="font-size: 10px;">4. Hover over nodes to see which emotion they belong to</small><br>
        <small style="font-size: 10px;">5. Scroll within the graph area to zoom in or zoom out</small><br>
        <small style="font-size: 10px;">6. Click and drag empty areas to move the entire graph</small><br>
        <small style="font-size: 10px;">7. Hover over yellow nodes to view expressions on the right</small><br>
        <small style="font-size: 10px;">8. The expression images on the right side are scrollable</small><br>
    </div>
</div>

<div id="project-footer">
    <span style="font-size: small;color: rgba(123,135,138,0.75); font-family: 'SimSun';">designed by Jiufeng Li</span>
</div>
</body>
<!--    <script src="../D3jsConquer/js/d3.v5.min.js"></script>-->
<script src="https://d3js.org/d3.v5.min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        // Tooltips visibility management
        window.tooltipsVisible = true;
        
        // Auto-show tooltips when in Circle mode (no text visible)
        window.updateTooltipsAutoDisplay = function() {
            var isCircleMode = $('.texts text:visible').length === 0;
            if (isCircleMode && !window.tooltipsVisible) {
                window.tooltipsVisible = true;
                $("#tooltips").removeClass("tooltips-hidden").addClass("tooltips-visible");
                $("#tooltips-toggle").html("üí° Tips");
            }
        };
        
        // Tooltips toggle functionality
        $("#tooltips-toggle").on("click", function() {
            window.tooltipsVisible = !window.tooltipsVisible;
            if (window.tooltipsVisible) {
                $("#tooltips").removeClass("tooltips-hidden").addClass("tooltips-visible");
                $(this).html("üí° Tips");
            } else {
                $("#tooltips").removeClass("tooltips-visible").addClass("tooltips-hidden");
                $(this).html("üí° Show Tips");
            }
        });
        
        // Make canvas responsive
        var canvasElement = document.getElementById("canvas");
        var canvasWidth, canvasHeight;
        
        function resizeCanvas() {
            var windowWidth = window.innerWidth;
            if (windowWidth <= 480) {
                // Mobile phones
                canvasWidth = Math.min(windowWidth - 20, 350);
                canvasHeight = 400;
                canvasElement.style.marginLeft = "10px";
            } else if (windowWidth <= 768) {
                // Tablets
                canvasWidth = Math.min(windowWidth - 40, 600);
                canvasHeight = 500;
                canvasElement.style.marginLeft = "20px";
            } else {
                // Desktop
                canvasWidth = 880;
                canvasHeight = 580;
                canvasElement.style.marginLeft = "30px";
            }
            canvasElement.setAttribute("width", canvasWidth);
            canvasElement.setAttribute("height", canvasHeight);
        }
        
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // ÈÄâÂá∫ÂΩìÂâçÁîªÂ∏ÉÂØπË±°obj
        var canvas = d3.select("#canvas");
        var width = canvasElement.getAttribute("width");
        var height = canvasElement.getAttribute("height");
        // console.log(canvas, width, height);

        const EMOTION_NAMES = ['Center', 'Emotion', 'Category', 'WordEmotion']; //, 'WordEmotion'
        const RELATION_NAMES = {"SUBCLASS_OF": "Subclass", "PART_OF": "Part of", "RELATED_TO": "Related"};
        const CIRCLE_SIZE = [25, 16, 12, 10];
        const LABEL_TEXT_FONT_SIZE = [20, 16, 10, 8];
        const EMOTION_CATEGORIES = ["Âø´‰πê", "ÂÆâÂøÉ", "Â∞äÊï¨", "ËµûÊâ¨", "Áõ∏‰ø°", "ÂñúÁà±", "Á•ùÊÑø", "ÊÑ§ÊÄí", "ÊÇ≤‰º§", "Â§±Êúõ", "Áñö",
            "ÊÄù", "ÊÖå", "ÊÅêÊÉß", "Áæû", "ÁÉ¶Èó∑", "ÊÜéÊÅ∂", "Ë¥¨Ë¥£", "Â¶íÂøå", "ÊÄÄÁñë", "ÊÉäÂ•á"];

        const EMOTIONS = ["‰πê", "Â•Ω", "ÊÄí", "ÂìÄ", "ÊÉß", "ÊÅ∂", "ÊÉä"];
        
        // Bilingual emotion name mapping
        const EMOTION_DISPLAY_NAMES = {
            "Ë°®ÊÉÖ": "Ë°®ÊÉÖ (Emotion)",
            "‰πê": "‰πê (Joy)",
            "Â•Ω": "Â•Ω (Good)",
            "ÊÄí": "ÊÄí (Anger)",
            "ÂìÄ": "ÂìÄ (Sadness)",
            "ÊÉß": "ÊÉß (Fear)",
            "ÊÅ∂": "ÊÅ∂ (Disgust)",
            "ÊÉä": "ÊÉä (Surprise)"
        };
        
        // Function to get display name
        function getDisplayName(name) {
            return EMOTION_DISPLAY_NAMES[name] || name;
        }

        // console.log(CircleSize["EmotionCenter"]);
        const NODE_COLORS = ['rgba(160,134,48,0.98)', 'rgba(142,74,74,0.98)', 'rgba(66,131,80,0.96)', "rgba(102,93,145,0.96)"];

        for (var i = 0; i < EMOTION_NAMES.length; i++) {
            $('#label').append("<div><span style='background-color:" + NODE_COLORS[i] + "'></span>" + EMOTION_NAMES[i] +"</div>")
        }

        // var graph = d3.json("./assets/graph/emotion-net.json", function (data) {

        //ÂÆöÂà∂ÁªìÁÇπÁöÑÁõ∏‰∫í‰ΩúÁî®Âäõ
        var forceManyBody = d3.forceManyBody()
            .strength(-46)   //ÂæÆÂ∞èÊéíÊñ•ÂäõÔºåÂÆö‰πâ‰∫ÜÂäõËÉΩÂ§üÂ∞ÜÁªìÁÇπpush 5px
            .distanceMin(1) //ÂÆö‰πâ‰∏Ä‰∏™ÊúÄÂ∞èË∑ùÁ¶ªÔºåÂè™ÊúâÂ§ß‰∫éËøô‰∏™Ë∑ùÁ¶ªÊâç‰ºö‰∫ßÁîü‰ΩúÁî®Âäõ
            .distanceMax(1500);

        //ÂÆöÂà∂ËæπÁöÑÁâµÂºïÂäõ
        var forceLink = d3.forceLink()
            .distance(50)
            .iterations(4);

        //ÂÆöÂà∂ÁªìÁÇπÁöÑÁ¢∞ÊíûÂäõ
        var forceCollide =  d3.forceCollide()
            .radius(20)
            .iterations(4);

        var forceRadial = d3.forceRadial(25);

        var forceCenter = d3.forceCenter(width / 2, height / 2);


        //ÂÆö‰πâÁ¢∞ÊíûÂäõÔºåÈò≤Ê≠¢ÁªìÁÇπoverlapping
        //d3.forceCollide(int radius) ‰º†ÂÖ•‰∏Ä‰∏™Á¢∞ÊíûÂçäÂæÑ
        //collide.strength(float strength) ‰º†ÂÖ•‰∏Ä‰∏™ÊµÆÁÇπÂûãÁ¢∞ÊíûÂäõÈáèÔºåÁî®‰∫éËÆ°ÁÆóÁ¢∞ÊíûËΩ®ËøπÔºàË∂äÂ§ßËÆ°ÁÆóË∂äÂø´ÔºåÂºÄÈîÄË∂äÂ§ßÔºâÈªòËÆ§0.7Ôºà0~1‰πãÈó¥ÂèñÂÄºÔºâ
        //collide.iterations(int count) countÂÄºË∂äÂ§ßÔºåÁ¢∞ÊíûÁöÑÂàöÊÄß(rigidity of the constraint)Ë∂äÂº∫

        // var forceCollide = d3.forceCollide(2);

        var nodes, links, node, link, lineText, text;
        /**
         * promiseÂºÇÊ≠•Ë∞ÉÁî®Êú∫Âà∂
         */
        d3.json("./assets/mini-graph/mini-emotion-net.json").then(function (data) {
            // var links = graph.links.map(d => Object.create(d));
            // var nodes = graph.nodes.map(d => Object.create(d));
            nodes = data.nodes;
            links = data.links;

            //updateÊï∞ÊçÆ
            link = canvas.append('g')
                .attr("class", "links")
                .selectAll("line")
                .data(links)
                .enter()
                .append("line")
                .attr('stroke-width', d => 1)
                .attr('class', 'darkMode');  // Start with dark mode

            //Ëæπ‰∏äÁöÑÊñáÂ≠óÔºàÂÆû‰Ωì‰πãÈó¥ÁöÑÂÖ≥Á≥ªÔºâ
            lineText = canvas.append('g')
                .attr("class", "lineTexts")
                .selectAll("text")
                .data(links)
                .enter()
                .append("text")
                .attr("class", "darkMode inactive")  // Start with dark mode
                .text(d => RELATION_NAMES[d.relation]);

            //‰∏∫ËäÇÁÇπÂíåËæπÊñΩÂä†ÂêÑÁßç‰ΩúÁî®Âäõ
            //ÂÆöÂà∂ÂäõÊ®°ÊãüÂô®ÔºåÂπ∂Ê∑ªÂä†ÂêÑÁßçÂÆöÂà∂ÁöÑÂäõ
            var simulation = d3.forceSimulation()
                .nodes(nodes)
                .velocityDecay(0.6)
                .force("link", forceLink.links(links).id(d => d.id))
                .force("charge", forceManyBody)
                // .force("radial", forceRadial)
                .force("collide", forceCollide)
                .force("center", forceCenter);

            // Ê∑ªÂä†ÊâÄÊúâÁöÑnode
            node = canvas.append('g')
                .attr('class', 'nodes')
                .selectAll('circle')
                .data(nodes)
                .enter()
                .append('circle')
                .attr("r", d => CIRCLE_SIZE[d.group - 1])
                .attr('fill', d => NODE_COLORS[d.group - 1])
                .attr('stroke', 'none')    // Ê≤°ÊúâÊèèËæπ
                .attr('name', d => d.id)
                .attr('class', 'darkMode')  // Start with dark mode
                .call(drag(simulation));   // ÊãñÂä®ÁªìÊùü

            // ÊñáÊú¨
            // ‰∏§ÁßçÊòæÁ§∫Ê®°ÂºèÔºåÊØè‰∏™ÁªìÁÇπÂèØ‰ª•Áî®‰∏Ä‰∏™ÂúÜÊàñËÄÖÊñáÊú¨Ë°®Á§∫
            text = canvas.append('g')
                .attr("class", "texts")
                .selectAll("text")
                .data(nodes)
                .enter()
                .append("text")
                .attr("display", "none")
                .attr("font-size", d => LABEL_TEXT_FONT_SIZE[d.group - 1])
                .attr("fill", d => NODE_COLORS[d.group - 1])
                .attr('name', d => d.id)
                .text(d => getDisplayName(d.id))
                .attr('text-anchor', 'middle')
                .call(drag(simulation));

            // ÁªônodeÂä†title, ÂΩìÈº†Ê†áÊÇ¨ÊµÆÂú®ÂúÜÂúà‰∏äÁöÑÊó∂ÂÄô
            node.append('title').text(d => getDisplayName(d.id));

            // $("#canvas").on("mouseenter", function (e) {
            //     d3.select("#canvas").attr("class",  "showBorder");
            // });
            //
            // $("#canvas").on("mouseleave", function (e) {
            //     d3.select("#canvas").removeClass("showBorder");
            // });


            simulation.on("tick", ticked);

            var PositionBias = 350;
            scaleLinear = d3.scaleLinear([0, 10], d3.range(30));
            var PositionFactor = Math.floor(Math.random() * 10 + 1);
            var PositionJustify = scaleLinear(PositionFactor);

            function ensureXInCanvas(x) {
                var alterX = x;
                if (x > width + PositionBias) alterX = width - PositionJustify;
                if (x < 0 - PositionBias) alterX = PositionJustify;
                return alterX;
            }

            function ensureYInCanvas(y) {
                var alterY = y;
                if (y > height + PositionBias) alterY = height - PositionJustify;
                if (y < 0 - PositionBias) alterY = PositionJustify;
                return alterY;
            }

            function ticked() {
                //Êõ¥Êñ∞ÊØèÊù°ËæπÁöÑ‰∏§‰∏™Á´ØÁÇπÁöÑÂΩìÂâçx,yÂÄº
                //ÊØèÊ¨°tickÂìçËµ∑ÔºåÊñΩÂä†Âäõ
                //ÊØè‰∏™ËäÇÁÇπÈÄüÂ∫¶ v = v * (1 - alphaDecay)
                link
                    .attr("x1", d => ensureXInCanvas(d.source.x))
                    .attr("y1", d => ensureYInCanvas(d.source.y))
                    .attr("x2", d => ensureXInCanvas(d.target.x))
                    .attr("y2", d => ensureYInCanvas(d.target.y));

                //Êõ¥Êñ∞ÊØè‰∏™ÁªìÁÇπÁöÑ‰∏≠ÂøÉÂùêÊ†áÂÄºcx, cy
                node
                    .attr("cx", d => ensureXInCanvas(d.x))
                    .attr("cy", d => ensureYInCanvas(d.y));

                lineText
                    .attr("dx", d => (d.source.x + d.target.x) / 2)
                    .attr("dy", d => (d.source.y + d.target.y) / 2);

                text
                    .attr("dx", d => ensureXInCanvas(d.x))
                    .attr("dy", d => ensureYInCanvas(d.y));
            }

            var isDragging = false;
            function drag(simulation) {
                //ÂºÄÂßãÊãñÊãΩ
                function dragstarted(d) {
                    if (!d3.event.active) simulation.alphaTarget(0.3).restart();
                    d.fx = d.x;
                    d.fy = d.y;
                    isDragging = true;
                }

                function dragged(d) {
                    d.fx = d3.event.x;
                    d.fy = d3.event.y;
                }

                function dragended(d) {
                    if (!d3.event.active) simulation.alphaTarget(0);
                    d.fx = null;
                    d.fy = null;
                    isDragging = false;
                }
                return d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended);
            }

            // Â§ÑÁêÜÁº©Êîæ
            canvas.call(d3.zoom()
                .scaleExtent([1 / 4, 4])
                .on("zoom", zoomed));

            function zoomed() {
                link.attr("transform", d3.event.transform);
                node.attr("transform", d3.event.transform);
                text.attr("transform", d3.event.transform);
                lineText.attr('transform', d3.event.transform);
            }

            //Ê†πÊçÆÊ®°ÂºèÂàáÊç¢Êõ¥Êñ∞ÊòæÁ§∫Êï∞ÊçÆ
            $('#mode span').click(function(event) {
                // ÊäämodeÈáåÈù¢ÊâÄÊúâspanÁöÑactiveÂÖ®ÈÉ®ÂéªÊéâ
                // ÊääË¢´ÁÇπÂáªÁöÑËøô‰∏™ËÆæÁΩÆ‰∏∫active
                $('#mode span').removeClass('active');
                $(this).addClass('active');

                if ($(this).text() == 'Circles') {
                    // ÈöêËóèÊâÄÊúâÊñáÊú¨ÈáåÈù¢ÁöÑsvgÂÖÉÁ¥†
                    // ÊäänodeÈáåÈù¢ÁöÑÊòæÁ§∫Âá∫Êù•
                    $('.texts text').hide();
                    $('.nodes circle').show();
                    
                    // Auto-show tooltips in circle mode
                    setTimeout(function() {
                        if (typeof updateTooltipsAutoDisplay === 'function') {
                            updateTooltipsAutoDisplay();
                        }
                    }, 100);

                }
                else {
                    $('.texts text').show();
                    $('.nodes circle').hide();
                }
            });

            // ‰∏Ä‰∏™labelÂºÄÂÖ≥Êï∞ÁªÑÔºåtrueË°®Á§∫ÊâìÂºÄon, falseË°®Á§∫off
            //NaN‰∏∫Êï∞ÁªÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÁî®‰∫éÂç†‰Ωç
            var switcher = [NaN, true, true, true, true];

            // Â§ÑÁêÜCenterÂºÄÂÖ≥ÁÇπÂáªÂêéÁöÑ‰∫ã‰ª∂
            $('#switcher1 span').click(function() {
                // ÊäämodeÈáåÈù¢ÊâÄÊúâspanÁöÑactiveÂÖ®ÈÉ®ÂéªÊéâ
                // ÊääË¢´ÁÇπÂáªÁöÑËøô‰∏™ËÆæÁΩÆ‰∏∫active
                $('#switcher1 span').removeClass('active');
                $(this).addClass('active');
                var addDarkModeClass = '';
                if (DARKMODE) {
                    addDarkModeClass = "darkMode ";
                }
                //ÊòæÁ§∫‰∏≠ÂøÉË°®ÊÉÖ
                if ($(this).text() =='On') {
                    //ÊâæÂà∞Â±û‰∫éÂΩìÂâçgroupÁöÑËäÇÁÇπÔºåÂπ∂‰∏îÊòæÁ§∫ÂÖ∂Áõ∏ËøûÁöÑËæπ
                    switcher[1] = true;
                    d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){

                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive'
                        }
                    });

                    //ÊòæÁ§∫Ëæπ
                    d3.select("#canvas .links").selectAll('line').attr('class', function(d) {
                        if (switcher[d.source.group] && switcher[d.target.group]) {
                            return addDarkModeClass;
                        } else {
                            return addDarkModeClass + 'inactive';
                        }
                    });
                    d3.select('#canvas .texts').selectAll('text').attr('class', function(d){
                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else {
                            return addDarkModeClass + 'inactive'
                        }
                    });
                }
                //ÁÜÑÁÅ≠ËäÇÁÇπÂíå‰∏é‰πãÂÖ≥ËÅîÁöÑËæπ
                else {
                    switcher[1] = false;
                    d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){
                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else {
                            return addDarkModeClass + 'inactive'
                        }
                    });

                    //ÁÜÑÁÅ≠EmotionCenterËøûÊé•ÁöÑËæπ
                    d3.select("#canvas .links").selectAll('line').attr('class', function(d) {
                        if (switcher[d.source.group] && switcher[d.target.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + "inactive";
                        }
                    });

                    //ÁÜÑÁÅ≠EmotionCenterËäÇÁÇπÁöÑÊñáÂ≠ó
                    d3.select('#canvas .texts').selectAll('text').attr('class', function(d){
                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                }
            });

            // Â§ÑÁêÜCategoryÂºÄÂÖ≥ÁÇπÂáªÂêéÁöÑ‰∫ã‰ª∂
            $('#switcher2 span').click(function() {
                $('#switcher2 span').removeClass('active');
                $(this).addClass('active');
                var addDarkModeClass = '';
                if (DARKMODE) {
                    addDarkModeClass = "darkMode ";
                }
                //ÊòæÁ§∫EmotionCategoryË°®ÊÉÖÁ±ªÂà´
                if ($(this).text() =='On') {
                    //ÊâæÂà∞Â±û‰∫éÂΩìÂâçgroupÁöÑËäÇÁÇπÔºåÂπ∂‰∏îÊòæÁ§∫ÂÖ∂Áõ∏ËøûÁöÑËæπ
                    switcher[2] = true;
                    d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });

                    d3.select("#canvas .links").selectAll('line').attr('class', function(d) {
                        if (switcher[d.source.group] && switcher[d.target.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                    d3.select('#canvas .texts').selectAll('text').attr('class', function(d){
                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                }
                //ÁÜÑÁÅ≠ËäÇÁÇπÂíå‰∏é‰πãÂÖ≥ËÅîÁöÑËæπ
                else {
                    switcher[2] = false;
                    d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });

                    //ÁÜÑÁÅ≠CategoryËøûÊé•ÁöÑËæπ
                    d3.select("#canvas .links").selectAll('line').attr('class', function(d) {
                        if (switcher[d.source.group] && switcher[d.target.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });

                    //ÁÜÑÁÅ≠CategoryËäÇÁÇπÁöÑÊñáÂ≠ó
                    d3.select('#canvas .texts').selectAll('text').attr('class', function(d){
                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                }
            });

            // Â§ÑÁêÜEmotionÂºÄÂÖ≥‰∫ã‰ª∂
            $('#switcher3 span').click(function() {
                $('#switcher3 span').removeClass('active');
                $(this).addClass('active');
                var addDarkModeClass = '';
                if (DARKMODE) {
                    addDarkModeClass = "darkMode ";
                }
                //ÊòæÁ§∫EmotionsË°®ÊÉÖÁªÜÁ±ªÂà´
                if ($(this).text() =='On') {
                    //ÊâæÂà∞Â±û‰∫éÂΩìÂâçgroupÁöÑËäÇÁÇπÔºåÂπ∂‰∏îÊòæÁ§∫ÂÖ∂Áõ∏ËøûÁöÑËæπ
                    switcher[3] = true;
                    d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });

                    //ÊòæÁ§∫Ëæπ
                    d3.select("#canvas .links").selectAll('line').attr('class', function(d) {
                        if (switcher[d.source.group] && switcher[d.target.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                    d3.select('#canvas .texts').selectAll('text').attr('class', function(d){
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                }
                //ÁÜÑÁÅ≠EmotionËäÇÁÇπÂíå‰∏é‰πãÂÖ≥ËÅîÁöÑËæπ
                else {
                    switcher[3] = false;
                    d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){
                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });

                    //ÁÜÑÁÅ≠EmotionCenterËøûÊé•ÁöÑËæπ
                    d3.select("#canvas .links").selectAll('line').attr('class', function(d) {
                        if (switcher[d.source.group] && switcher[d.target.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });


                    d3.select('#canvas .texts').selectAll('text').attr('class', function(d){
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                }
            });

            // Â§ÑÁêÜWordEmotionÂºÄÂÖ≥‰∫ã‰ª∂
            $('#switcher4 span').click(function() {
                // ÊäämodeÈáåÈù¢ÊâÄÊúâspanÁöÑactiveÂÖ®ÈÉ®ÂéªÊéâ
                // ÊääË¢´ÁÇπÂáªÁöÑËøô‰∏™ËÆæÁΩÆ‰∏∫active
                $('#switcher4 span').removeClass('active');
                $(this).addClass('active');
                var addDarkModeClass = '';
                if (DARKMODE) {
                    addDarkModeClass = "darkMode ";
                }
                //ÊòæÁ§∫‰∏≠ÂøÉË°®ÊÉÖ
                if ($(this).text() =='On') {
                    //ÊâæÂà∞Â±û‰∫éÂΩìÂâçgroupÁöÑËäÇÁÇπÔºåÂπ∂‰∏îÊòæÁ§∫ÂÖ∂Áõ∏ËøûÁöÑËæπ
                    switcher[4] = true;
                    d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){
                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });

                    //ÊòæÁ§∫Ëæπ
                    d3.select("#canvas .links").selectAll('line').attr('class', function(d) {
                        if (switcher[d.source.group] && switcher[d.target.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                    d3.select('#canvas .texts').selectAll('text').attr('class', function(d){
                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                }
                //ÁÜÑÁÅ≠WordEmotionËäÇÁÇπÂíå‰∏é‰πãÂÖ≥ËÅîÁöÑËæπ
                else {
                    switcher[4] = false;
                    d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){
                        // ÂΩìÂâçWordEmotionËäÇÁÇπÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });

                    //ÁÜÑÁÅ≠WordEmotionÁ±ªËäÇÁÇπ‰∏äËøûÊé•ÁöÑËæπ
                    d3.select("#canvas .links").selectAll('line').attr('class', function(d) {
                        if (switcher[d.source.group] && switcher[d.target.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });

                    //ÁÜÑÁÅ≠WordEmotionÁ±ªËäÇÁÇπ‰∏äÁöÑÊñáÂ≠ó
                    d3.select('#canvas .texts').selectAll('text').attr('class', function(d){
                        // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                        if (switcher[d.group]) {
                            return addDarkModeClass;
                        } else{
                            return addDarkModeClass + 'inactive';
                        }
                    });
                }
            });

            // function loadData(url, callback) {
            //     var rawFile = new XMLHttpRequest();
            //     rawFile.open("GET", url, true);
            //     rawFile.onreadystatechange = function() {
            //         if (rawFile.readyState === 4 && rawFile.status == "200") {
            //             callback(rawFile.responseText);
            //         }
            //     };
            //     rawFile.send(null);
            // }
            //
            // loadData("../../EmotionNet/assets/mini-graph/mini-label-info.json", d =>  labelInfoAll = JSON.parse(d));
            // loadData("../../EmotionNet/assets/mini-graph/mini-emotion-net.json", d =>  emotionNet = JSON.parse(d));

            var labelInfoAll;
            const imageNums = 10;
            const IMAGE_CATEGORIES = ['HA1_P', 'GD1_P', 'AN1_P', 'SA1_P', 'FE1_P', 'DI1_P', 'SU1_P'];
            const ANIMAL_EMOTIONS_NUMS = 3;
            const IMAGE_CATEGORIES_ANIMALS = ['happy_0', 'good_0', 'angry_0', 'sad_0', 'fear_0',
                'disgust_0', 'surprise_0'];


            /**
             * Â§ÑÁêÜËäÇÁÇπËÅöÁÑ¶‰∫ã‰ª∂
             * handle node's focus event
             */
            var DARKMODE = true;
            
            // Apply dark mode on page load
            $(document).ready(function() {
                $("body").addClass("darkMode");
                $("#emotionNetName").addClass("darkMode");
                $("#label").addClass("darkMode");
                $("#mode span").addClass("darkMode");
                $("#darkMode span").addClass("darkMode").html("<strong>light mode</strong>");
                $("#switcher1 span").addClass("darkMode");
                $("#switcher2 span").addClass("darkMode");
                $("#switcher3 span").addClass("darkMode");
                $("#switcher4 span").addClass("darkMode");
                $("#tooltips").addClass("darkMode");
                $("#search input").addClass("darkMode");
                $("#canvas").addClass("darkMode");
            });
            
            // d3.json("./assets/mini-graph/mini-emotion-net.json");
            d3.json("./assets/mini-graph/mini-label-info.json").then(function (data) {
                labelInfoAll = data;

                $("#darkMode").on("click", function (e) {
                    DARKMODE = !DARKMODE;
                    if (DARKMODE) {
                        $("body").addClass("darkMode");
                        $("#emotionNetName").addClass("darkMode");
                        $("#label").addClass("darkMode");
                        $("#mode span").addClass("darkMode");
                        $("#darkMode span").addClass("darkMode").html("<strong>light mode</strong>");
                        $("#switcher1 span").addClass("darkMode");
                        $("#switcher2 span").addClass("darkMode");
                        $("#switcher3 span").addClass("darkMode");
                        $("#switcher4 span").addClass("darkMode");
                        $("#tooltips").addClass("darkMode");
                        $("#search input").addClass("darkMode");
                        $("#canvas").addClass("darkMode");
                        var addDarkModeClass = 'darkMode ';
                        d3.select('#canvas .links').selectAll('line').attr('class', function(d) {
                            if (switcher[d.source.group] && switcher[d.target.group]) {
                                return addDarkModeClass;
                            } else {
                                return addDarkModeClass + 'inactive';
                            }
                        });
                        d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){
                            if (switcher[d.group]) {
                                return addDarkModeClass;
                            } else{
                                return addDarkModeClass + 'inactive'
                            }
                        });
                        d3.select('#canvas .lineTexts').selectAll('text').attr('class', 'darkMode inactive');

                    } else {
                        $("body").removeClass("darkMode");
                        $("#emotionNetName").removeClass("darkMode");
                        $("#label").removeClass("darkMode");
                        $("#mode span").removeClass("darkMode");
                        $("#darkMode span").removeClass("darkMode").html("<strong>dark mode</strong>");
                        $("#switcher1 span").removeClass("darkMode");
                        $("#switcher2 span").removeClass("darkMode");
                        $("#switcher3 span").removeClass("darkMode");
                        $("#switcher4 span").removeClass("darkMode");
                        $("#tooltips").removeClass("darkMode");
                        $("#search input").removeClass("darkMode");
                        $("#canvas").removeClass("darkMode");
                        $(".links line").removeClass("darkMode");

                        var linksClassList = d3.select('#canvas .links').selectAll('line').attr('class').replace("darkMode", '');
                        d3.select('#canvas .links').selectAll('line').attr('class', function(d) {
                            if (switcher[d.source.group] && switcher[d.target.group]) {
                                return linksClassList;
                            } else {
                                return linksClassList + 'inactive';
                            }
                        });
                        var nodesClassList = d3.select('#canvas .nodes').selectAll('circle').attr('class').replace("darkMode", '');
                        d3.select('#canvas .nodes').selectAll('circle').attr('class', function(d){
                            if (switcher[d.group]) {
                                return nodesClassList;
                            } else{
                                return nodesClassList + 'inactive'
                            }
                        });
                        var textClassList = d3.select('#canvas .lineTexts').selectAll('text').attr('class').replace("darkMode", '');
                        d3.select('#canvas .lineTexts').selectAll('text').attr('class', textClassList);

                    }
                });

                var addDarkModeClass = '';
                if (DARKMODE) {
                    addDarkModeClass = "darkMode ";
                }

                $("#canvas").on("mouseenter", ".nodes circle", function (e) {
                    console.log(addDarkModeClass);
                    if (!isDragging) {
                        //ÂèñÂá∫ÂΩìÂâçÈº†Ê†áËøõÂÖ•ËäÇÁÇπÁöÑÂêçÂ≠óÔºå‰ª•‰æøÂêéÁª≠ËøõË°åËäÇÁÇπÈöêËóè
                        var focusedNode = $(this).attr("name");
                        $("#subclass").empty();
                        $("#description").empty();
                        $("#faceImageContainer1").empty();
                        $("#faceImageContainer2").empty();
                        $("#faceImageContainer3").empty();
                        $("#emojiImageContainer").empty();
                        $("#animalImageContainer").empty();
                        $("#animalImageContainer2").empty();
                        $("#animalImageContainer3").empty();
                        $("#tag1").empty();
                        $("#tag2").empty();
                        $("#tag3").empty();
                        $("#tag4").empty();
                        $("#tag5").empty();
                        $("#tag6").empty();

                        $("#labelProperty h4").css("color", $(this).attr("fill")).text(getDisplayName($(this).attr("name")));

                        //ËÆæÁΩÆÂõæÁâáÁÇπÂáªÂèëÂÖâÂíå‰∏äÁßªÁâπÊïà
                        $('#faceImageContainer1').on("mouseenter", '.imageItem', function () {
                            $(this).css("top", "-6px")
                                .css("transition", "top o.3s")
                                .css("-o-transition", "top .3s")
                                .css( "-ms-transition", "top .3s")
                                .css(  "-moz-transition", "top .3s")
                                .css("-webkit-transition", "top .3s")
                                .addClass("shiningBorder");
                        });

                        $('#faceImageContainer1').on("mouseleave", '.imageItem', function () {
                            $(this).css("top", "0").removeClass("shiningBorder");
                        });

                        $('#faceImageContainer2').on("mouseenter", '.imageItem', function () {
                            $(this).css("top", "-6px")
                                .css("transition", "top o.3s")
                                .css("-o-transition", "top .3s")
                                .css( "-ms-transition", "top .3s")
                                .css(  "-moz-transition", "top .3s")
                                .css("-webkit-transition", "top .3s")
                                .addClass("shiningBorder");
                        });
                        $('#faceImageContainer2').on("mouseleave", '.imageItem', function () {
                            $(this).css("top", "0").removeClass("shiningBorder");
                        });

                        $('#faceImageContainer3').on("mouseenter", '.imageItem', function () {
                            $(this).css("top", "-6px")
                                .css("transition", "top o.3s")
                                .css("-o-transition", "top .3s")
                                .css( "-ms-transition", "top .3s")
                                .css(  "-moz-transition", "top .3s")
                                .css("-webkit-transition", "top .3s")
                                .addClass("shiningBorder");
                        });
                        $('#faceImageContainer3').on("mouseleave", '.imageItem', function () {
                            $(this).css("top", "0").removeClass("shiningBorder");
                        });

                        $('#emojiImageContainer').on("mouseenter", '.imageItem', function () {
                            $(this).css("top", "-6px")
                                .css("transition", "top o.3s")
                                .css("-o-transition", "top .3s")
                                .css( "-ms-transition", "top .3s")
                                .css(  "-moz-transition", "top .3s")
                                .css("-webkit-transition", "top .3s")
                                .addClass("shiningBorder");
                        });
                        $('#emojiImageContainer').on("mouseleave", '.imageItem', function () {
                            $(this).css("top", "0").removeClass("shiningBorder");
                        });

                        $('#animalImageContainer').on("mouseenter", '.imageItem', function () {
                            $(this).css("top", "-6px")
                                .css("transition", "top o.3s")
                                .css("-o-transition", "top .3s")
                                .css( "-ms-transition", "top .3s")
                                .css(  "-moz-transition", "top .3s")
                                .css("-webkit-transition", "top .3s")
                                .addClass("shiningBorder");
                        });
                        $('#animalImageContainer').on("mouseleave", '.imageItem', function () {
                            $(this).css("top", "0").removeClass("shiningBorder");
                        });

                        $('#animalImageContainer2').on("mouseenter", '.imageItem', function () {
                            $(this).css("top", "-6px")
                                .css("transition", "top o.3s")
                                .css("-o-transition", "top .3s")
                                .css( "-ms-transition", "top .3s")
                                .css(  "-moz-transition", "top .3s")
                                .css("-webkit-transition", "top .3s")
                                .addClass("shiningBorder");
                        });
                        $('#animalImageContainer2').on("mouseleave", '.imageItem', function () {
                            $(this).css("top", "0").removeClass("shiningBorder");
                        });

                        $('#animalImageContainer3').on("mouseenter", '.imageItem', function () {
                            $(this).css("top", "-6px")
                                .css("transition", "top o.3s")
                                .css("-o-transition", "top .3s")
                                .css( "-ms-transition", "top .3s")
                                .css(  "-moz-transition", "top .3s")
                                .css("-webkit-transition", "top .3s")
                                .addClass("shiningBorder");
                        });
                        $('#animalImageContainer3').on("mouseleave", '.imageItem', function () {
                            $(this).css("top", "0").removeClass("shiningBorder");
                        });

                        var labelInfo = labelInfoAll[focusedNode];
                        //ÈíàÂØπ‰∏çÂêåÁ±ªÂà´ÊÉÖÁª™ËøõË°åÂàÜÁ±ªÂà´Â±ïÁ§∫ÔºàÂ∞èÁ±ªÊÉÖÁª™ËØçÊ≤°ÊúâÂõæÁâáÔºâ
                        //ÂØπÊÉÖÁª™Â§ßÁ±ªÁöÑPropertyÂ±ïÁ§∫
                        // $('.imageContent ul li').on('mouseenter', function () {
                        //     $(this).css('border', '1px wihtesomke solid')
                        // });
                        // $('.imageContent ul li').on('mousemove', '.imageContent ul li', function () {
                        //     $(this).css('display', 'block')
                        // })

                        if (EMOTIONS.indexOf(focusedNode) != -1 || focusedNode == "Ë°®ÊÉÖ") {
                            // $("#labelProperty").append("image").attr()
                            $("#subclass")
                                .append("<span class='label label-default' style='margin-left: -2px; color: lightgrey;'>" + "Subclass" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + labelInfo.SUBCLASS_OF + "</span>");

                            $("#description")
                                .append("<div><span class='label label-default' style='margin-left: -2px; color: lightgrey;'>" + "Description" + "</span><br></div>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + labelInfo.DESCRIPTION + "</span>");

                            if (focusedNode == "Ë°®ÊÉÖ") {
                                var e;
                                $("#description")
                                    .append("<div><span class='label label-default' style='margin-left: -2px; background-color:#665d91;color: lightgrey;'>" + "Human Face Expressions" + "</span><br></div>");

                                for (let i = 0; i < IMAGE_CATEGORIES.length; i++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/human-face-emotions/" + IMAGE_CATEGORIES[i] + "1.png" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px; padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer1").append(e);
                                }

                                $("#tag1").append("<br>");
                                for (let i = 0; i < IMAGE_CATEGORIES.length; i++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/human-face-emotions/" + IMAGE_CATEGORIES[i] + "2.png" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px; padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer2").append(e);
                                }

                                $("#tag2").append("<br>");
                                for (let i = 0; i < IMAGE_CATEGORIES.length; i++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/human-face-emotions/" + IMAGE_CATEGORIES[i] + "6.png" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer3").append(e);
                                }

                                $("#tag3").append("<br><div><span class='label' style='margin-left: -2px; background-color:#944b4b;color: lightgrey;'>" + "Social Media Emojis" + "</span><br></div>");
                                for (let i = 0; i < IMAGE_CATEGORIES.length; i++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/social-media-emotions/" + IMAGE_CATEGORIES[i] + "1.jpg" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#emojiImageContainer").append(e);

                                }
                                $("#tag4").append("<br><div><span class='label' style='margin-left: -2px; background-color:#227636;color: lightgrey;'>" + "Animal Expressions" + "</span><br></div>");
                                for (let i = 0; i < IMAGE_CATEGORIES_ANIMALS.length; i++) {
                                    for (let j = 1; j <= 3; j++) {
                                        e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                        e += "./assets/images/animal-cat-emotions/" + IMAGE_CATEGORIES_ANIMALS[i] + j + ".jpg" + "'";
                                        e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                        $("#animalImageContainer").append(e);
                                    }
                                }

                                $("#tag5").append("<br>");
                                for (let i = 0; i < IMAGE_CATEGORIES_ANIMALS.length; i++) {
                                    for (let j = 1; j <= 3; j++) {
                                        e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                        e += "./assets/images/animal-dog-emotions/" + IMAGE_CATEGORIES_ANIMALS[i] + j + ".jpg" + "'";
                                        e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                        $("#animalImageContainer2").append(e);
                                    }
                                }

                                $("#tag6").append("<br>");
                                for (let i = 0; i < IMAGE_CATEGORIES_ANIMALS.length; i++) {
                                    for (let j = 1; j <= 3; j++) {
                                        e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                        e += "./assets/images/animal-hamster-emotions/" + IMAGE_CATEGORIES_ANIMALS[i] + j + ".jpg" + "'";
                                        e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                        $("#animalImageContainer3").append(e);
                                    }
                                }
                            }
                            // Â±ïÁ§∫ÊÉÖÊÑüÂ§ßÁ±ª(emotion category)
                            else {
                                var emotionType = IMAGE_CATEGORIES[EMOTIONS.indexOf(focusedNode)];
                                var animalEmotionType = IMAGE_CATEGORIES_ANIMALS[EMOTIONS.indexOf(focusedNode)];

                                $("#description")
                                    .append("<div><span class='label' style='margin-left: -2px; background-color:#665d91;color: lightgrey;'>" + "Human Face Expressions" + "</span><br></div>");

                                for (let i = 0; i < imageNums; i++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/human-face-emotions/" + emotionType + (i + 1) + ".png" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer1").append(e);
                                }

                                var emojiNums = 7;
                                $("#tag1").append("<br><div><span class='label' style='margin-left: -2px; background-color:#944b4b;color: lightgrey;'>" + "Social Media Emojis" + "</span><br></div>")
                                for (let i = 0; i < emojiNums; i++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/social-media-emotions/" + emotionType + (i+1) + ".jpg" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer2").append(e);
                                }

                                var animalEmotionsNum = 3;
                                $("#tag2").append("<br><div><span class='label' style='margin-left: -2px; background-color:#227636;color: lightgrey;'>" + "Animal Expressions" + "</span><br></div>")
                                for (let j = 0; j < animalEmotionsNum; j++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/animal-cat-emotions/" + animalEmotionType + (j+1) + ".jpg" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer3").append(e);
                                }
                                for (let j = 0; j < animalEmotionsNum; j++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/animal-dog-emotions/" + animalEmotionType + (j+1) + ".jpg" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer3").append(e);
                                }
                                for (let j = 0; j < animalEmotionsNum; j++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/animal-hamster-emotions/" + animalEmotionType + (j+1) + ".jpg" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer3").append(e);
                                }

                            }

                            // Â±ïÁ§∫ÊÉÖÊÑüÂ≠êÁ±ª(emotions subclass)
                        } else if (EMOTION_CATEGORIES.indexOf(focusedNode) != -1) {
                            $("#subclass")
                                .append("<span class='label label-default' style='margin-left: -2px; color: lightgrey;'>" + "Subclass" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + labelInfo.SUBCLASS_OF + "</span>");
                        } else {
                            // Â±ïÁ§∫ÊÉÖÊÑüËØçÂ±ûÊÄßÂàóË°®Ôºàword emotion feature)
                            var propertyValue = Object.values(labelInfo);
                            var relatedEmotion;
                            if(propertyValue[1] == ""){
                                relatedEmotion  = "Êó†"
                            } else{
                                relatedEmotion = propertyValue[1];
                            }
                            const wordPolarity = ["Neutral", "Positive", "Negative", "Both"];

                            $("#description")
                                .append("<span class='label label-default' style='margin-left: -2px; color: lightgrey;'>" + "Belongs to" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + propertyValue[0] + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background-color: cornflowerblue'>" + "Related" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + relatedEmotion + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background-color: #3e8e41'>" + "Part of Speech" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + propertyValue[2] + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background-color: #a7a82e'>" + "Intensity" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + propertyValue[3] + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background-color:#944b4b;'>" + "Meanings" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + propertyValue[4] + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background:#665d91;'>" + "Polarity" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + wordPolarity[propertyValue[5]] + "</span><br>");

                        }

                        //ÈÅçÂéÜÊâÄÊúâÁªìÁÇπÔºåÈÄâÂá∫‰∏éËÅöÁÑ¶ËäÇÁÇπÁõ¥Êé•Áõ∏ËøûÁöÑËäÇÁÇπ
                        d3.select("#canvas").selectAll(".nodes circle").attr("class", function (d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            //ËÅöÁÑ¶ËäÇÁÇπ
                            if (d.id == focusedNode) {
                                return addDarkModeClass;
                            }
                            // ÊòæÁ§∫‰∏éÂΩìÂâçËÅöÁÑ¶ËäÇÁÇπÁõ¥Êé•Áõ∏ËøûÂπ∂‰∏îÂØπÂ∫îÁöÑswitcherÂºÄÂÖ≥ÊâìÂºÄÁöÑÁöÑËäÇÁÇπ
                            for (var i = 0; i < links.length; i++) {
                                if (links[i].source.id == focusedNode && links[i].target.id == d.id) {
                                    if (switcher[links[i].target.group]) {
                                        return addDarkModeClass;
                                    } else {
                                        return addDarkModeClass + "inactive";
                                    }
                                }
                                if (links[i].target.id  == focusedNode && links[i].source.id  == d.id) {
                                    if (switcher[links[i].source.group]) {
                                        return addDarkModeClass;
                                    } else {
                                        return addDarkModeClass + "inactive";
                                    }
                                }
                            }
                            return addDarkModeClass + "inactive";
                        });

                        // ÊòæÁ§∫‰∏éÂΩìÂâçËÅöÁÑ¶ËäÇÁÇπÁõ¥Êé•Áõ∏ËøûÁöÑËæπ
                        d3.select("#canvas").selectAll(".links line").attr("class", function (d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            // console.log(d.source.id);
                            // console.log(focusedNode.name);
                            if (d.source.id == focusedNode || d.target.id == focusedNode) {
                                if (switcher[d.source.group] && switcher[d.target.group]) {
                                    return addDarkModeClass + 'focus';
                                } else {
                                    return addDarkModeClass + "inactive";
                                }
                            }
                            return addDarkModeClass + 'inactive';
                        });

                        // Âè™ÊòæÁ§∫‰πãÈó¥Áõ∏ËøûÁöÑÂÖ≥Á≥ªÂêç
                        d3.select("#canvas").selectAll('.lineTexts text').attr('class', function(d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            if (d.source.id == focusedNode || d.target.id == focusedNode) {
                                if (switcher[d.source.group] && switcher[d.target.group]) {
                                    return addDarkModeClass;
                                } else {
                                    return addDarkModeClass + "inactive";
                                }
                            } else {
                                return addDarkModeClass + "inactive";
                            }
                        });

                        //ÂΩìÈº†Ê†áÊÇ¨ÂÅú‰∏éÂúÜÂúàËäÇÁÇπÊó∂ÔºåÂØπÊâÄÊúâTextÊñáÊú¨ËäÇÁÇπËøõË°åÈöêËóè
                        d3.select('#canvas').selectAll('.texts text').attr('class', function(d){
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            if (d.id == focusedNode) {
                                return addDarkModeClass;
                            }
                            for (var i = 0; i < links.length; i++) {
                                if (links[i]['source'].id == focusedNode && links[i]['target'].id == d.id) {
                                    return addDarkModeClass;
                                }
                                if (links[i]['target'].id == focusedNode && links[i]['source'].id == d.id) {
                                    return addDarkModeClass;
                                }
                            }
                            return addDarkModeClass + 'inactive';
                        });
                    }
                });

                //ÂΩìÈº†Ê†á‰∏çÂú®ËÅöÁÑ¶Âà∞Êüê‰∏™ÈÄâÂÆöÁöÑËäÇÁÇπÊó∂
                $('#canvas').on('mouseleave', '.nodes circle', function(event) {
                    if (!isDragging) {
                        //ÈöêËóèÊâÄÊúâËæπÁöÑÂÖ≥Á≥ª
                        $(".lineTexts text").addClass("inactive");
                        //ÂèñÊ∂àfocusÁâπÊïà
                        $(".links line").removeClass("focus");

                        // $(".links line").removeClass("inactive");

                        // ÊòæÁ§∫Ê†áÁ≠æ‰∏∫onÁöÑÊâÄÊúâÁªìÁÇπÔºåÂ¶ÇÊûúswitchÂºÄÂÖ≥Â§Ñ‰∫éoffÔºåÂàôËÆæÁΩÆ‰∏∫inactive
                        d3.select('#canvas').selectAll(".nodes circle").attr('class', function(d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            //‰Ωç‰∫égroup1‰∏îÂºÄÂÖ≥Ê†áÁ≠æ‰∏∫onÂàôÊòæÁ§∫
                            if (switcher[d.group]) {
                                return addDarkModeClass;
                            } else {
                                return addDarkModeClass + 'inactive'
                            }
                        });
                        //ÈÄâ‰∏≠Ê†áÁ≠æÂºÄÂÖ≥‰∏∫onÁöÑËäÇÁÇπÊâÄËøûÊé•ÁöÑËæπ
                        d3.select("#canvas").selectAll('.links line').attr('class', function(d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            //ÈÄâ‰∏≠Ëæπ‰∏äÈ¶ñÂ∞æËäÇÁÇπÂ±û‰∫éÂêåÁ±ªÔºåÂπ∂‰∏îÊâÄÂ±ûÊ†áÁ≠æÂºÄÂÖ≥‰∏∫ÂºÄÁöÑËäÇÁÇπÁªô‰∫àÊòæÁ§∫
                            if (switcher[d.source.group] && switcher[d.target.group]) {
                                return addDarkModeClass;
                            } else{
                                return addDarkModeClass + "inactive";
                            }
                        });
                        //ÈÄâ‰∏≠Ê†áÁ≠æËäÇÁÇπ‰∏∫on‰∏≠ÁöÑÊâÄÊúâÊñáÊú¨ËäÇÁÇπÊòæÁ§∫
                        d3.select('#canvas').selectAll('.texts text').attr('class', function(d){
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                            if (switcher[d.group]) {
                                return addDarkModeClass;
                            } else{
                                return addDarkModeClass + 'inactive'
                            }
                        });
                    }
                });

                $("#canvas").on("mouseenter", ".texts text", function (e) {
                    if (!isDragging) {
                        //ÂèñÂá∫ÂΩìÂâçÈº†Ê†áËøõÂÖ•ËäÇÁÇπÁöÑÂêçÂ≠óÔºå‰ª•‰æøÂêéÁª≠ËøõË°åËäÇÁÇπÈöêËóè
                        var focusedNode = $(this).attr("name");
                        // Á°ÆÂÆöÊòæÁ§∫Ê®°Âºè
                        // Á°ÆÂÆöÊòæÁ§∫Ê®°Âºè
                        $("#subclass").empty();
                        $("#description").empty();
                        $("#faceImageContainer1").empty();
                        $("#faceImageContainer2").empty();
                        $("#faceImageContainer3").empty();
                        $("#emojiImageContainer").empty();
                        $("#animalImageContainer").empty();
                        $("#animalImageContainer2").empty();
                        $("#animalImageContainer3").empty();
                        $("#tag1").empty();
                        $("#tag2").empty();
                        $("#tag3").empty();
                        $("#tag4").empty();
                        $("#tag5").empty();
                        $("#tag6").empty();

                        $("#labelProperty h4").css("color", $(this).attr("fill")).text(getDisplayName($(this).attr("name")));
                        var labelInfo = labelInfoAll[focusedNode];
                        //ÈíàÂØπ‰∏çÂêåÁ±ªÂà´ÊÉÖÁª™ËøõË°åÂàÜÁ±ªÂà´Â±ïÁ§∫ÔºàÂ∞èÁ±ªÊÉÖÁª™ËØçÊ≤°ÊúâÂõæÁâáÔºâ
                        //ÂØπÊÉÖÁª™Â§ßÁ±ªÁöÑPropertyÂ±ïÁ§∫
                        if (EMOTIONS.indexOf(focusedNode) != -1 || focusedNode == "Ë°®ÊÉÖ") {
                            // $("#labelProperty").append("image").attr()
                            // Â±ïÁ§∫Â≠êÁ±ªÊÉÖÁª™‰ø°ÊÅØ
                            $("#subclass")
                                .append("<span class='label label-default' style='margin-left: -2px; color: lightgrey;'>" + "Subclass" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + labelInfo.SUBCLASS_OF + "</span>");

                            // ‰∏∫ÊØè‰∏™ÊÉÖÊÑüÂ§ßÁ±ªÊ∑ªÂä†ÊèèËø∞‰ø°ÊÅØ
                            $("#description")
                                .append("<div><span class='label label-default' style='margin-left: -2px; color: lightgrey;'>" + "Description" + "</span><br></div>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + labelInfo.DESCRIPTION + "</span>");

                            if (focusedNode == "Ë°®ÊÉÖ") {
                                var e;

                                $("#description")
                                    .append("<div><span class='label label-default' style='margin-left: -2px; background-color:#665d91;color: lightgrey;'>" + "Human Face Expressions" + "</span><br></div>")

                                for (let i = 0; i < IMAGE_CATEGORIES.length; i++) {
                                    e = "<li style='display: inline-block; width:57px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/human-face-emotions/" + IMAGE_CATEGORIES[i] + "1.png" + "'";
                                    e += "class='img-responsive img-thumbnail' alt='Responsive image' style='padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer1").append(e);
                                }

                                $("#tag1").append("<br>");
                                for (let i = 0; i < IMAGE_CATEGORIES.length; i++) {
                                    e = "<li style='display: inline-block; width:57px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/human-face-emotions/" + IMAGE_CATEGORIES[i] + "2.png" + "'";
                                    e += "class='img-responsive img-thumbnail' alt='Responsive image' style='padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer2").append(e);
                                }

                                $("#tag2").append("<br>");
                                for (let i = 0; i < IMAGE_CATEGORIES.length; i++) {
                                    e = "<li style='display: inline-block; width:57px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/human-face-emotions/" + IMAGE_CATEGORIES[i] + "6.png" + "'";
                                    e += "class='img-responsive img-thumbnail' alt='Responsive image' style='padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer3").append(e);
                                }

                                $("#tag3").append("<br><div><span class='label' style='margin-left: -2px; background-color:#944b4b;color: lightgrey;'>" + "Social Media Emojis" + "</span><br></div>")
                                for (let i = 0; i < IMAGE_CATEGORIES.length; i++) {
                                    e = "<li style='display: inline-block; width:57px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/social-media-emotions/" + IMAGE_CATEGORIES[i] + "1.jpg" + "'";
                                    e += "class='img-responsive img-thumbnail' alt='Responsive image' style='padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#emojiImageContainer").append(e);
                                }

                                $("#tag4").append("<br><div><span class='label' style='margin-left: -2px; background-color:#227636;color: lightgrey;'>" + "Animal Expressions" + "</span><br></div>");
                                for (let i = 0; i < IMAGE_CATEGORIES_ANIMALS.length; i++) {
                                    for (let j = 1; j <= 3; j++) {
                                        e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                        e += "./assets/images/animal-cat-emotions/" + IMAGE_CATEGORIES_ANIMALS[i] + j + ".jpg" + "'";
                                        e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                        $("#animalImageContainer").append(e);
                                    }
                                }

                                $("#tag5").append("<br>");
                                for (let i = 0; i < IMAGE_CATEGORIES_ANIMALS.length; i++) {
                                    for (let j = 1; j <= 3; j++) {
                                        e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                        e += "./assets/images/animal-dog-emotions/" + IMAGE_CATEGORIES_ANIMALS[i] + j + ".jpg" + "'";
                                        e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                        $("#animalImageContainer2").append(e);
                                    }
                                }

                                $("#tag6").append("<br>");
                                for (let i = 0; i < IMAGE_CATEGORIES_ANIMALS.length; i++) {
                                    for (let j = 1; j <= 3; j++) {
                                        e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                        e += "./assets/images/animal-hamster-emotions/" + IMAGE_CATEGORIES_ANIMALS[i] + j + ".jpg" + "'";
                                        e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                        $("#animalImageContainer3").append(e);
                                    }
                                }
                            }

                            // Â±ïÁ§∫ÊÉÖÊÑüÂ§ßÁ±ª
                            else {
                                var emotionType = IMAGE_CATEGORIES[EMOTIONS.indexOf(focusedNode)];
                                var animalEmotionType = IMAGE_CATEGORIES_ANIMALS[EMOTIONS.indexOf(focusedNode)];

                                $("#description")
                                    .append("<div><span class='label' style='margin-left: -2px; background-color:#665d91;color: lightgrey;'>" + "Human Face Expressions" + "</span><br></div>");

                                for (let i = 0; i < imageNums; i++) {
                                    e = "<li style='display: inline-block; width:57px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/human-face-emotions/" + emotionType + (i + 1) + ".png" + "'";
                                    e += "class='img-responsive img-thumbnail' alt='Responsive image' style='padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer1").append(e);
                                }

                                const emojiNums = 7;
                                $("#tag1").append("<br><div><span class='label' style='margin-left: -2px; background-color:#944b4b;color: lightgrey;'>" + "Social Media Emojis" + "</span><br></div>")
                                for (let i = 0; i < emojiNums; i++) {
                                    e = "<li style='display: inline-block; width:57px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/social-media-emotions/" + emotionType + (i+1) + ".jpg" + "'";
                                    e += "class='img-responsive img-thumbnail' alt='Responsive image' style='padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer2").append(e);
                                }

                                var animalEmotionsNum = 3;
                                $("#tag2").append("<br><div><span class='label' style='margin-left: -2px; background-color:#227636;color: lightgrey;'>" + "Animal Expressions" + "</span><br></div>")
                                for (let j = 0; j < animalEmotionsNum; j++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/animal-cat-emotions/" + animalEmotionType + (j+1) + ".jpg" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer3").append(e);
                                }
                                for (let j = 0; j < animalEmotionsNum; j++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/animal-dog-emotions/" + animalEmotionType + (j+1) + ".jpg" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer3").append(e);
                                }
                                for (let j = 0; j < animalEmotionsNum; j++) {
                                    e = "<li style='display: inline-block; width:60px; padding-top: 4px; padding-bottom: 2px; padding-left: 2px; text-align:left; list-style:none;'><img src='";
                                    e += "./assets/images/animal-hamster-emotions/" + animalEmotionType + (j+1) + ".jpg" + "'";
                                    e += "class='img-responsive img-thumbnail imageItem' alt='Responsive image' style='position:relative; margin:1px 0px;padding:2px; width: 55px; height: 55px;'></li>";
                                    $("#faceImageContainer3").append(e);
                                }
                            }

                            // Â±ïÁ§∫ÊÉÖÊÑüÂ∞èÁ±ª
                        } else if (EMOTION_CATEGORIES.indexOf(focusedNode) != -1) {
                            $("#subclass")
                                .append("<span class='label label-default' style='margin-left: -2px; color: lightgrey;'>" + "Subclass" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + labelInfo.SUBCLASS_OF + "</span>");
                        } else {
                            var propertyValue = Object.values(labelInfo);
                            var relatedEmotion;
                            if(propertyValue[1] == ""){
                                relatedEmotion  = "Êó†"
                            } else{
                                relatedEmotion = propertyValue[1];
                            }
                            const wordPolarity = ["Neutral", "Positive", "Negative", "Both"];

                            $("#description")
                                .append("<span class='label label-default' style='margin-left: -2px; color: lightgrey;'>" + "Belongs to" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + propertyValue[0] + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background-color: cornflowerblue'>" + "Related" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + relatedEmotion + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background-color: #3e8e41'>" + "Part of Speech" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + propertyValue[2] + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background-color: #a7a82e'>" + "Intensity" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + propertyValue[3] + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background-color:#944b4b;'>" + "Meanings" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + propertyValue[4] + "</span><br>")
                                .append("<span class='label ' style='margin-left: -2px; color: lightgrey;background:#665d91;'>" + "Polarity" + "</span><br>")
                                .append("<span style='color: #555555; font-size:12px; font-family:'Microsoft Yahei''>" + wordPolarity[propertyValue[5]] + "</span><br>");

                        }

                        //ÈÅçÂéÜÊâÄÊúâÊñáÊú¨ÁªìÁÇπÔºåÈÄâÂá∫‰∏éËÅöÁÑ¶ËäÇÁÇπÁõ¥Êé•Áõ∏ËøûÁöÑÊñáÊú¨ËäÇÁÇπ
                        d3.select("#canvas").selectAll(".texts text").attr("class", function (d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            //ËÅöÁÑ¶ËäÇÁÇπ
                            if (d.id == focusedNode) {
                                return addDarkModeClass;
                            }
                            // ÊòæÁ§∫‰∏éÂΩìÂâçËÅöÁÑ¶ËäÇÁÇπÁõ¥Êé•Áõ∏ËøûÁöÑËäÇÁÇπ
                            for (var i = 0; i < links.length; i++) {
                                if (links[i].source.id == focusedNode && links[i].target.id == d.id) {
                                    if (switcher[links[i].target.group]) {
                                        return addDarkModeClass;
                                    } else {
                                        return addDarkModeClass + "inactive";
                                    }
                                }
                                if (links[i].target.id  == focusedNode && links[i].source.id  == d.id) {
                                    if (switcher[links[i].source.group]) {
                                        return addDarkModeClass;
                                    } else {
                                        return addDarkModeClass + "inactive";
                                    }
                                }
                            }
                            return addDarkModeClass + "inactive";
                        });

                        // ÊòæÁ§∫‰∏éÂΩìÂâçËÅöÁÑ¶ËäÇÁÇπÁõ¥Êé•Áõ∏ËøûÁöÑËæπ
                        d3.select("#canvas").selectAll(".links line").attr("class", function (d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            // console.log(d.source.id);
                            // console.log(focusedNode.name);
                            if (d.source.id == focusedNode || d.target.id == focusedNode) {
                                if (switcher[d.source.group] && switcher[d.target.group]) {
                                    return addDarkModeClass + 'focus';
                                } else {
                                    return addDarkModeClass + "inactive";
                                }
                            }
                            return addDarkModeClass + 'inactive';
                        });

                        // Âè™ÊòæÁ§∫‰πãÈó¥Áõ∏ËøûÁöÑÂÖ≥Á≥ªÂêç
                        d3.select("#canvas").selectAll('.lineTexts text').attr('class', function(d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            if (d.source.id == focusedNode || d.target.id == focusedNode) {
                                if (switcher[d.source.group] && switcher[d.target.group]) {
                                    return addDarkModeClass;
                                } else {
                                    return addDarkModeClass + "inactive";
                                }
                            }
                            return addDarkModeClass + 'inactive';
                        });

                        //ÂΩìÈº†Ê†áÊÇ¨ÂÅú‰∫éÊñáÊú¨ËäÇÁÇπÊó∂ÔºåÂØπÊâÄÊúâNodesËäÇÁÇπËøõË°åÈöêËóè
                        d3.select('#canvas').selectAll('.nodes circle').attr('class', function(d){
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            if (d.id == focusedNode) {
                                return addDarkModeClass;
                            }
                            for (var i = 0; i < links.length; i++) {
                                if (links[i]['source'].id == focusedNode && links[i]['target'].id == d.id) {
                                    return addDarkModeClass;
                                }
                                if (links[i]['target'].id == focusedNode && links[i]['source'].id == d.id) {
                                    return addDarkModeClass;
                                }
                            }
                            return addDarkModeClass + 'inactive';
                        });
                    }
                });

                //ÂΩìÈº†Ê†á‰∏çÂú®ËÅöÁÑ¶Âà∞Êüê‰∏™ÈÄâÂÆöÁöÑËäÇÁÇπÊó∂
                $('#canvas').on('mouseleave', '.texts text', function(event) {
                    if (!isDragging) {
                        //ÈöêËóèÊâÄÊúâËæπÁöÑÂÖ≥Á≥ª
                        $(".lineTexts text").addClass("inactive");
                        $(".links line").removeClass("focus");
                        // $(".links line").removeClass("inactive");
                        $(".nodes circle").removeClass("inactive");
                        // ÊòæÁ§∫Ê†áÁ≠æ‰∏∫OffÁöÑÊâÄÊúâÊñáÊú¨ÁªìÁÇπÔºåÂ¶ÇÊûúswitchÂºÄÂÖ≥Â§Ñ‰∫éoffÂπ∂Â±û‰∫éÂΩìÂâçÊ†áÁ≠æÔºåÂàôËÆæÁΩÆ‰∏∫active
                        d3.select('#canvas').selectAll(".texts text").attr('class', function(d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            if (switcher[d.group]) {
                                return addDarkModeClass;
                            } else{
                                return addDarkModeClass + 'inactive'
                            }
                        });
                        //ÈÄâ‰∏≠Ê†áÁ≠æÂºÄÂÖ≥‰∏∫onÁöÑËäÇÁÇπÊâÄËøûÊé•ÁöÑËæπ
                        d3.select("#canvas").selectAll('.links line').attr('class', function(d) {
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            if (switcher[d.source.group] && switcher[d.target.group]) {
                                return addDarkModeClass;
                            } else{
                                return addDarkModeClass + "inactive";
                            }
                        });
                        //ÈÄâ‰∏≠Ê†áÁ≠æËäÇÁÇπ‰∏∫on‰∏≠ÁöÑÊâÄÊúâÊñáÊú¨ËäÇÁÇπÊòæÁ§∫
                        d3.select('#canvas').selectAll('.nodes node').attr('class', function(d){
                            var addDarkModeClass = '';
                            if (DARKMODE) {
                                addDarkModeClass = "darkMode ";
                            }
                            // ÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÂÆû‰ΩìÊòæÁ§∫
                            if (switcher[d.group]) {
                                return addDarkModeClass;
                            } else{
                                return addDarkModeClass + 'inactive'
                            }
                        });
                    }
                });
            });
        });
    });
</script>
</html>